import { authenticator } from 'otplib'; import qrcode from 'qrcode'; export function generateMfaSecret(email) { const secret = authenticator.generateSecret(); const otpauth = authenticator.keyuri(email, 'ODSP', secret); return { secret, otpauth }; } export async function generateQrCodeDataUrl(otpauth) { return qrcode.toDataURL(otpauth); } export function verifyMfaToken(secret, token) { return authenticator.verify({ token, secret }); }
