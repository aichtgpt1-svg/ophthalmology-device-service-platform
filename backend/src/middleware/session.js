 import jwt from 'jsonwebtoken'; export function verifyToken(req, res, next) { const hdr = req.headers.authorization; if (!hdr) return res.status(401).json({ message: 'Missing token' }); const [scheme, token] = hdr.split(' '); if (scheme !== 'Bearer' || !token) return res.status(401).json({ message: 'Malformed token' }); try { const decoded = jwt.verify(token, process.env.JWT_SECRET); req.user = decoded; return next(); } catch { return res.status(401).json({ message: 'Invalid or expired token' }); } }